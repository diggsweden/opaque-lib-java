# SPDX-FileCopyrightText: 2025 Digg - Agency for Digital Government
#
# SPDX-License-Identifier: CC0-1.0

# Gitleaks configuration for secret scanning

[extend]
# Use default gitleaks rules
useDefault = true

# Allowlist for test files containing example/test data, not real secrets
[allowlist]
description = "Ignore test files with example passwords and test vectors"
paths = [
  # Test file with example password "sdflkj098234sdf-" (not a real secret)
  '''src/test/java/se/digg/crypto/opaque/crypto/impl/SimplifiedOpaqueCurveTest\.java''',
  # Test vectors file with cryptographic test data (standard OPAQUE test vectors from RFC)
  '''src/test/resources/opaque-test-vectors\.json'''
]
